let pokemonRepository = (function () {
	let e = [];
	function t(t) {
		"object" == typeof t && "name" in t ? e.push(t) : console.error("Invalid Pok\xe9mon data");
	}
	function o() {
		return e;
	}
	async function n() {
		i();
		try {
			let e = await fetch("https://pokeapi.co/api/v2/pokemon/?limit=150"),
				o = await e.json();
			o.results.forEach((e) => {
				t({ name: e.name, detailsUrl: e.url });
			});
		} catch (n) {
			console.error(n);
		}
		d();
	}
	async function r(e) {
		let t = e.detailsUrl;
		i();
		try {
			let o = await fetch(t),
				n = await o.json();
			(e.imageUrl = n.sprites.front_default), (e.height = n.height), (e.types = n.types);
		} catch (r) {
			console.error(r);
		}
		d();
	}
	function a(e) {
		r(e).then(() => {
			var t;
			let o, n;
			(t = e),
				(o = document.querySelector(".modal-body")),
				(o.innerHTML = ""),
				o.appendChild(l("h1", t.name)),
				o.appendChild(l("p", "Height: " + t.height)),
				(n = l("img")),
				(n.src = t.imageUrl),
				o.appendChild(n);
		});
	}
	function l(e, t) {
		let o = document.createElement(e);
		return t && (o.innerText = t), o;
	}
	function i() {
		let e = l("p", "Loading data from the Pok\xe9mon API...");
		document.body.appendChild(e);
	}
	function d() {
		document.querySelector("p").remove();
	}
	return {
		add: t,
		getAll: o,
		addListItem: function e(t) {
			let o = document.querySelector(".pokemon-list"),
				n = document.createElement("div");
			n.classList.add("col-lg-3", "col-md-4", "col-sm-6", "mb-4");
			let r = document.createElement("div");
			r.classList.add("card");
			let l = document.createElement("button");
			(l.innerText = t.name),
				l.classList.add("btn", "btn-primary"),
				l.setAttribute("data-toggle", "modal"),
				l.setAttribute("data-target", "#pokemonModal"),
				r.appendChild(l),
				n.appendChild(r),
				o.appendChild(n),
				l.addEventListener("click", function () {
					a(t);
				});
		},
		showDetails: a,
		loadList: n,
		loadDetails: r,
	};
})();
function populateGrid(e) {
	let t = document.getElementById("grid-container");
	e.forEach((e) => {
		fetch(e.url)
			.then((e) => e.json())
			.then((e) => {
				let o = document.createElement("div");
				o.className = "grid-box";
				let n = document.createElement("img");
				(n.src = e.sprites.front_default), (n.alt = e.name), (n.className = "thumbnail");
				let r = document.createElement("h3");
				(r.textContent = e.name), o.appendChild(n), o.appendChild(r), t.appendChild(o);
			})
			.catch((t) => console.error(`An error occurred fetching ${e.name}:`, t));
	});
}
function filterGrid() {
	let e = document.getElementById("search-input").value.toLowerCase(),
		t = document.querySelectorAll(".grid-box");
	t.forEach((t) => {
		let o = t.querySelector("h3").textContent.toLowerCase();
		o.includes(e) ? (t.style.display = "block") : (t.style.display = "none");
	});
}
function returnToHome() {
	(document.getElementById("searchBar").value = ""),
		(document.querySelector(".pokemon-list").innerHTML = ""),
		pokemonRepository.getAll().forEach((e) => {
			pokemonRepository.addListItem(e);
		});
}
pokemonRepository.loadList().then(() => {
	pokemonRepository.getAll().forEach((e) => {
		pokemonRepository.addListItem(e);
	});
}),
	document.getElementById("searchBar").addEventListener("keyup", (e) => {
		let t = e.target.value.toLowerCase(),
			o = pokemonRepository.getAll().filter((e) => e.name.toLowerCase().includes(t));
		(document.querySelector(".pokemon-list").innerHTML = ""),
			o.forEach((e) => {
				pokemonRepository.addListItem(e);
			});
	}),
	fetch("https://pokeapi.co/api/v2/pokemon/?limit=150")
		.then((e) => e.json())
		.then((e) => populateGrid(e.results))
		.catch((e) => console.error("An error occurred:", e)),
	document.getElementById("homeButton").addEventListener("click", returnToHome);
